{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Manager</title>
    <link rel="stylesheet" type="text/css" href="{% static 'portfolio/style.css' %}">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <img src="https://i.imgur.com/wqYqZqA.png" alt="Left Logo" class="header-logo-left">
                </div>
                <div class="header-center">
                    <h1>PRUDEV II Portfolio Manager</h1>
                    <nav class="nav">
                        <a href="{% url 'home' %}" class="nav-link active">Dashboard</a>
                        <a href="{% url 'msme_list' %}" class="nav-link">MSME Database</a>
                        <a href="{% url 'upload_msme_data' %}" class="nav-link">Upload Data</a>
                        <a href="{% url 'msme_analytics' %}" class="nav-link">Analytics</a>
                    </nav>
                </div>
                <div class="header-right">
                    <img src="https://i.imgur.com/XRMJQhd.png" alt="Right Logo" class="header-logo-right">
                </div>
            </div>
        </header>

        <main class="main">
            <section class="dashboard">
                <h2>Dashboard</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total MSMEs</h3>
                        <p class="stat-value">{{ total_msmes }}</p>
                    </div>
                    <div class="stat-card">
                        <h3>Total BGEs</h3>
                        <p class="stat-value">{{ total_bges }}</p>
                    </div>
                    <div class="stat-card">
                        <h3>Total Annual Revenue</h3>
                        <p class="stat-value">{{ total_annual_revenue|floatformat:0 }}</p>
                    </div>
                    <div class="stat-card">
                        <h3>Total Employees</h3>
                        <p class="stat-value">{{ total_employees }}</p>
                    </div>
                    <div class="stat-card">
                        <h3>By Business Type</h3>
                        <ul>
                        {% for type, count in business_type_stats.items %}
                            <li>{{ type }}: {{ count }}</li>
                        {% endfor %}
                        </ul>
                    </div>
                    <div class="stat-card">
                        <h3>By Sector</h3>
                        <ul>
                        {% for sector, count in sector_stats.items %}
                            <li>{{ sector }}: {{ count }}</li>
                        {% endfor %}
                        </ul>
                    </div>
                    <div class="stat-card">
                        <h3>Suggestions</h3>
                        <ul>
                            {% if total_msmes > 0 and total_bges > 0 %}
                                <li>MSME to BGE ratio: {{ total_msmes|floatformat:0 }}:{{ total_bges|floatformat:0 }}</li>
                            {% endif %}
                            {% if total_annual_revenue > 0 and total_msmes > 0 %}
                                <li>Avg revenue per MSME: {{ avg_revenue_per_msme|floatformat:0 }}</li>
                            {% endif %}
                            {% if total_employees > 0 and total_msmes > 0 %}
                                <li>Avg employees per MSME: {{ avg_employees_per_msme|floatformat:1 }}</li>
                            {% endif %}
                            <li>Upload more data for better insights</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="recent-activity">
                <h2>Recent Activity</h2>
                <div class="activity-list">
                    {% if recent_transactions %}
                        {% for transaction in recent_transactions %}
                        <div class="activity-item">
                            <div class="activity-type {{ transaction.transaction_type|lower }}">
                                {{ transaction.transaction_type }}
                            </div>
                            <div class="activity-details">
                                <strong>{{ transaction.investment.name }}</strong>
                                <span class="activity-amount">${{ transaction.amount|floatformat:2 }}</span>
                                <span class="activity-date">{{ transaction.transaction_date|date:"M d, Y" }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="no-data">No recent activity. Start by creating your first portfolio!</p>
                    {% endif %}
                </div>
            </section>

            {% if portfolios %}
            <section class="portfolios">
                <h2>Your Portfolios</h2>
                <div class="portfolio-grid">
                    {% for portfolio in portfolios %}
                    <div class="portfolio-card">
                        <h3>{{ portfolio.name }}</h3>
                        <p class="portfolio-description">{{ portfolio.description|default:"No description" }}</p>
                        <div class="portfolio-stats">
                            <div class="portfolio-stat">
                                <span class="stat-label">Value:</span>
                                <span class="stat-value">${{ portfolio.total_value|floatformat:2 }}</span>
                            </div>
                            <div class="portfolio-stat">
                                <span class="stat-label">Return:</span>
                                <span class="stat-value {% if portfolio.total_return_percentage >= 0 %}positive{% else %}negative{% endif %}">
                                    {{ portfolio.total_return_percentage|floatformat:2 }}%
                                </span>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </section>
            {% endif %}

            <section class="quick-actions">
                <h2>Quick Actions</h2>
                <div class="actions-grid">
                    <a href="{% url 'upload_msme_data' %}" class="action-card">
                        <h3>Upload MSME Data</h3>
                        <p>Import Excel files with MSME information</p>
                    </a>
                    <a href="{% url 'upload_bge_data' %}" class="action-card">
                        <h3>Upload BGE Data</h3>
                        <p>Import Excel files with Business Growth Expert information</p>
                    </a>
                    <a href="{% url 'msme_list' %}" class="action-card">
                        <h3>View MSME Database</h3>
                        <p>Browse and search MSME records</p>
                    </a>
                    <a href="{% url 'msme_analytics' %}" class="action-card">
                        <h3>MSME Analytics</h3>
                        <p>View insights and statistics</p>
                    </a>
                    <a href="{% url 'bge_list' %}" class="action-card">
                        <h3>View BGEs</h3>
                        <p>Browse and search Business Growth Experts</p>
                    </a>
                    <a href="{% url 'bge_leaderboard' %}" class="action-card">
                        <h3>BGE Leaderboard</h3>
                        <p>See top Business Growth Experts by MSMEs supported</p>
                    </a>
                </div>
            </section>
        </main>
    </div>

    <script src="{% static 'portfolio/script.js' %}"></script>
</body>
</html> 